<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>Price Pie [#SummerOfLove]</title>
        <!-- css -->
        <style type="text/css">
            h1, h2 {
                text-align: center;
            }
            a {
                text-decoration: none
            }
            .pie {
                float: left;
            }
        </style>
        <!-- js -->
        <script src="/static/js/raphael-min.js" type="text/javascript"></script>
        <script src="/static/js/g.raphael-min.js" type="text/javascript"></script>
        <script src="/static/js/g.pie.js" type="text/javascript"></script>
        <script src="/static/js/jquery-1.7.2.min.js" type="text/javascript"></script>
        <script src="/static/js/jquery.qrcode.min.js" type="text/javascript"></script>
        
        <script>
            function drawPie(element, radius, which, data) {
                var paper = Raphael(element, radius * 2, radius * 2);
                paper.piechart(radius, radius, radius, data, {
                    colors: ['#3D499F','#F48CA6','#7BAFA5','#DDA127','#C41B7C'],
                })
                .click(function() { window.location.href = 'detail/' + which;})
                .hover(function() {
                    document.body.style.cursor = "pointer";
                    }, function() {
                    document.body.style.cursor = "default";
                });
            };

            $(document).ready(function() {
                // draw all the charts from the data
                var radius = 100;
                {% for pie in pies %}
                    var elname = 'pie' + {{ pie.id }};
                    var elqrname = 'pie' + {{ pie.id }} + 'qr';
                    var el = $('<div class="enclosure"><div id=' + elname + ' class="pie"></div><div id=' + elqrname + ' class="qrcode"></div></div><br/>');
                    el.appendTo($('#pie'));
                    drawPie(elname, radius, {{ pie.id }}, {{ pie.fieldarray }});
                    $('#' + elqrname).qrcode({
                        width: radius * 2,
                        height: radius * 2,
                        text: 'http://pricepie.ddns.net/qrcode/' + {{ pie.id }}
                    });
                {% endfor %}
                // create some qrcodes
            });
        </script>
    </head>
    <body>
        <h1>PricePie chart examples</h1>
        <h2>#SummerOfLove</h2>
        <br/>
        <div id="pie"></div>
        <div id="qrcode"></div>
    </body>
</html>
